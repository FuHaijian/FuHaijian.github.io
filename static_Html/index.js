const static_course = {
    "HTML":
        [
            {
                "id": 1,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第一课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["HTML","CSS"]
            },
            {
                "id": 2,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第二课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["HTML","CSS"]
            },
            {
                "id": 3,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第三课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["HTML", "CSS", "JavaScript"]
            }
        ],
    "CSS":
        [
            {
                "id": 4,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第四课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["CSS"]
            },
            {
                "id": 5,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第五课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["CSS"]
            },
            {
                "id": 6,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第六课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["HTML", "CSS"]
            }
        ],
    "JavaScript":
        [
            {
                "id": 7,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第七课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["JavaScript", "HTML"]
            },
            {
                "id": 8,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第八课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["JavaScript", "HTML", "CSS"]
            },
            {
                "id": 9,
                "course_img": "http://dummyimage.com/120x120",
                "course_title": "第九课 这里是课程名",
                "course_introduce": "这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要 这里是课程概要",
                "tags": ["JavaScript", "HTML", "CSS"]
            }
        ]
}
const static_provincesAndCities = {
    "省市1": [
        {
            "id": 'university1',
            "university_name": '示例大学'
        },
        {
            "id": 'university2',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university3',
            "university_name": '示例大学'
        },
        {
            "id": 'university4',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university5',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university100',
            "university_name": '示例大学'
        },
        {
            "id": 'university101',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university102',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university103',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university104',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university105',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university106',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university107',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university108',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university109',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university110',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university111',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市2": [
        {
            "id": 'university6',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university7',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university8',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university89',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市3": [
        {
            "id": 'university6',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university7',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university8',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university332',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university590',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市4": [
        {
            "id": 'university6',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university7',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university8',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university9',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university10',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市5": [
        {
            "id": 'university11',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university12',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university13',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university14',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university15',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university16',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university17',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university345',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university5122',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市6": [
        {
            "id": 'university18',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university19',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university20',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university21',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university22',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university23',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university24',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市7": [
        {
            "id": 'university25',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university26',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university27',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university28',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university29',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university30',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university31',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university43',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university523',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市8": [
        {
            "id": 'university32',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university33',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university34',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university35',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university36',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university37',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university38',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市9": [
        {
            "id": 'university39',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university40',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university41',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university42',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university43',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university44',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university45',
            "university_name": 'xxxxx大学'
        }
    ],
    "省市10": [
        {
            "id": 'university46',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university47',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university48',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university49',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university50',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university51',
            "university_name": 'xxxxx大学'
        },
        {
            "id": 'university52',
            "university_name": 'xxxxx大学'
        }
    ]
}
const static_year = [
    {
        "id": 'year1',
        "year": 2010 
    },
    {
        "id": 'year2',
        "year": 2011 
    },
    {
        "id": 'year3',
        "year": 2012 
    },
    {
        "id": 'year4',
        "year": 2013 
    },
    {
        "id": 'year5',
        "year": 2014 
    },
    {
        "id": 'year6',
        "year": 2015 
    },
    {
        "id": 'year7',
        "year": 2016 
    },
    {
        "id": 'year8',
        "year": 2017 
    },
    {
        "id": 'year9',
        "year": 2018 
    },
    {
        "id": 'year10',
        "year": 2019 
    },
    {
        "id": 'year11',
        "year": 2020 
    },
    {
        "id": 'year12',
        "year": 2021 
    },
]

let activeMenuBarIndex = "All";
const menu_All = document.getElementById('All'),
    menu_HTML = document.getElementById('HTML'),
    menu_CSS = document.getElementById('CSS'),
    menu_JavaScript = document.getElementById('JavaScript'),
    class_schedule__items = document.getElementById('class_schedule__items'),
    yourSchool_input = document.getElementById('yourSchool_input'),
    optionsWindow_school = document.querySelector('.optionsWindow_school'),
    optionsWindow_school__selected = document.querySelector('.optionsWindow_school__selected'),
    provincesAndCities = document.getElementById('provincesAndCities'),
    universities = document.getElementById('universities'),
    optionsWindow_year__selected = document.querySelector('.optionsWindow_year__selected'),
    startYear_input = document.getElementById('startYear_input'),
    optionsWindow_year = document.querySelector('.optionsWindow_year'),
    optionsWindow_year__list = document.getElementById('optionsWindow_year__list'),
    email_input_box = document.querySelector('#email_inputBox'),
    signUp = document.getElementById('signUp'),
    promptPopup = document.getElementById('promptPopup'),
    success_SignUp = document.querySelector('.success_SignUp'),
    re_enroll = document.querySelector('.re-enroll');

const setNav = (id) => {
    if(id == localStorage.getItem('active_nav')) {
        return
    }
    const nav = document.getElementById(`${id}`);
    const lastActiveNav = document.getElementById(`${localStorage.getItem('active_nav')}`);
    localStorage.setItem('active_nav', id)
    nav.className = 'navbar__items-item navbar__items-item--active';
    lastActiveNav.className = 'navbar__items-item';
}

// 课程列表逻辑
const style_Recovery = () => {
    menu_All.className = 'class_schedule__menuBar-item';
    menu_HTML.className = 'class_schedule__menuBar-item';
    menu_CSS.className = 'class_schedule__menuBar-item';
    menu_JavaScript.className = 'class_schedule__menuBar-item';
}
menu_All.addEventListener('click', async() => {
    style_Recovery();
    menu_All.className = 'class_schedule__menuBar-item class_schedule__menuBar-item--active';
    activeMenuBarIndex = 'All';
    await getCourseList();
})
menu_HTML.addEventListener('click', async() => {
    style_Recovery();
    menu_HTML.className = 'class_schedule__menuBar-item class_schedule__menuBar-item--active';
    activeMenuBarIndex = "HTML";
    await getCourseList();
})
menu_CSS.addEventListener('click', async() => {
    style_Recovery();
    menu_CSS.className = 'class_schedule__menuBar-item class_schedule__menuBar-item--active';
    activeMenuBarIndex = "CSS";
    await getCourseList();
})
menu_JavaScript.addEventListener('click', async() => {
    style_Recovery();
    menu_JavaScript.className = 'class_schedule__menuBar-item class_schedule__menuBar-item--active';
    activeMenuBarIndex = 'JavaScript';
    await getCourseList();
})
const getCourseList = () => {
    let item = []
    if (activeMenuBarIndex == 'All') {
        item = [...static_course["HTML"], ...static_course["CSS"], ...static_course["JavaScript"]];
    } else {
        item = static_course[activeMenuBarIndex];
    }
    class_schedule__items.innerHTML = '';
    for (let i = 0; i < item.length; i++) {
        class_schedule__items.innerHTML += `
        <div class="class_schedule__items-item">
            <img src="${item[i].course_img}" alt="" class="course_pic">
            <div class="course_info">
                <div class="course_info__courseName">${item[i].course_title}</div>
                <div class="course_info__courseIntroduction">${item[i].course_introduce}</div>
                <div class="course_info__tags" id='tags_${item[i].id}'></div>
            </div>
        </div>
        `
        const course_info__tags = document.getElementById(`tags_${item[i].id}`)
        let tags = item[i].tags;
        for (let j = 0; j < tags.length; j++) {
        course_info__tags.innerHTML += `
            <span id="tag_${tags[j]}">${tags[j]}</span>
        `
        }
    }
}

// 学校弹窗选择逻辑
yourSchool_input.addEventListener('click', async() => {
    if (optionsWindow_year.style.display == 'block') {
        optionsWindow_year.style.display = 'none';
    }
    optionsWindow_school.style.display = 'block';
    await provincesAndCitiesInit()
})
optionsWindow_school__selected.addEventListener('click', () => {
    optionsWindow_school.style.display = 'none';
})
const schoolPopupWindowDisappears = (id) => {
    const item = document.getElementById(`${id}`)
    optionsWindow_school__selected.innerHTML = item.innerHTML;
    yourSchool_input.innerHTML = optionsWindow_school__selected.innerHTML;
    optionsWindow_school.style.display = 'none';
}
const provincesAndCitiesInit = () => {
    provincesAndCities.innerHTML = '';
    for (let item in static_provincesAndCities) {
        if (item == '省市1') {
             provincesAndCities.innerHTML += `
                <div class="provincesAndCities__item provincesAndCities__item--active" id="${item}" onclick="setProvincesAndCities('${item}')">
                    ${item}
                </div>
            `
        } else {
            provincesAndCities.innerHTML += `
                <div class="provincesAndCities__item" id="${item}" onclick="setProvincesAndCities('${item}')">
                    ${item}
                </div>
            `
        }
        localStorage.setItem('active_ProvincesAndCities', '省市1')
    }
    let item = static_provincesAndCities['省市1']
    for (let i = 0; i < item.length; i++) {
        universities.innerHTML += `
        <div class="universities__item" id="${item[i].id}" onclick="schoolPopupWindowDisappears('${item[i].id}')">
            ${item[i].university_name}
        </div>
        `
    }
}
function setProvincesAndCities(key) {
    universities.innerHTML = '';
    const provincesAndCities__item = document.getElementById(`${key}`)
    let activeID = localStorage.getItem('active_ProvincesAndCities')
    const provincesAndCities__item_active = document.getElementById(`${activeID}`);
    localStorage.setItem('active_ProvincesAndCities', key)
    provincesAndCities__item.className = 'provincesAndCities__item provincesAndCities__item--active';
    provincesAndCities__item_active.className = 'provincesAndCities__item';
    let item = static_provincesAndCities[`${key}`];
    for (let i = 0; i < item.length; i++) {
        universities.innerHTML += `
        <div class="universities__item" id="${item[i].id}" onclick="schoolPopupWindowDisappears('${item[i].id}')">
            ${item[i].university_name}
        </div>
        `
    }
}
// 入学年份弹窗选择逻辑
startYear_input.addEventListener('click', () => {
    if (optionsWindow_school.style.display == 'block') {
        optionsWindow_school.style.display = 'none';
    }
    optionsWindow_year.style.display = 'block';
    startYearInit()
})
optionsWindow_year__selected.addEventListener('click', () => {
    optionsWindow_year.style.display = 'none';
})
const yearPopupWindowDisappears = (id) => {
    const item = document.getElementById(`${id}`)
    optionsWindow_year__selected.innerHTML = item.innerHTML;
    startYear_input.innerHTML = optionsWindow_year__selected.innerHTML;
    optionsWindow_year.style.display = 'none';
}
const startYearInit = () => {
    optionsWindow_year__list.innerHTML = ''
    for(let i = 0; i < static_year.length; i++) {
        optionsWindow_year__list.innerHTML += `
            <div class="optionsWindow_year__list-item" id="${static_year[i].id}" onclick="yearPopupWindowDisappears('${static_year[i].id}')">
                ${static_year[i].year}
            </div>
        `
    }
}
signUp.addEventListener('click', () => {
    let content = '';
    var res = /^\w+@[a-z0-9]+\.[a-z]{2,4}$/;
    if (!email_input_box.value.match(res)) {
        content = `邮箱地址不符合要求 (${email_input_box.value}), 请重新输入`;
        if (!optionsWindow_year__selected.innerHTML.trim()) {
            content = `请选择入学年份`;
        }
        if (!optionsWindow_school__selected.innerHTML.trim()) {
            content = `请选择省校`;
        }
    }    
    promptPopup.style.display = 'block';
    if (content) {
        promptPopup.style.backgroundColor = '#fe9799';
        setTimeout(() => {
            promptPopup.style.display = 'none';
        }, 3000)
    } else {
        content = `恭喜你, 来自${optionsWindow_school__selected.innerHTML.trim()} ${optionsWindow_year__selected.innerHTML.trim()}级 ${email_input_box.value.trim()} 同学, 您的报名信息已记录, 请关注您的邮件`;
        promptPopup.style.backgroundColor = '#a2ff8b';
        success_SignUp.style.display = 'block';
        setTimeout(() => {
            promptPopup.style.display = 'none';
        }, 5000)
    }
    promptPopup.innerHTML = content;
})
re_enroll.addEventListener('click', () => {
    success_SignUp.style.display = 'none';
})

window.onload = () => {
    getCourseList()
    localStorage.setItem('active_nav', 'nav1')
}


